# Direct Imaging of Exoplanets with Deep Learning
A public repository to store codes used in the paper "Pushing the Limits of Exoplanet Discovery via Direct Imaging with Deep Learning"

## Data
Data can be downloaded at: https://osf.io/ez7pk/

### Descirption of the data
Under CNN:
- master_training.npy: Collection of negative simulated frames (generated by GAN) used for training the CNN. 
- master_test.npy: Collection of negative simulated frames (generated by GAN) used for testing.
- tinyPSF.npy: Simulated PSF generated by TinyTim.

Under DR1:
Original Frames taken by NICMOS from the STScI Archive.

Under GAN:
- Real_train.npy: Filtered, normalised science frames used to train the GAN
- Real_test_unknown.npy: Normalised science frames reserved for data exploration.
- Real_test_confirmed.npy: Detected bright source signal, reserved for performance evaluation when CNN is trained.
## Paper

https://arxiv.org/pdf/1904.06155.pdf

## Running the GAN
To train the GAN, please type the following command in the terminal:

	$python train-dcgan.py --dataset LINK/TO/DATAFILES --epoch 35 --batch_size 50 â€”loss_ftn dcgan

Once you finished training the GAN, you can inspect its quality by asking it to generate images unseen by the network. 

	$python complete.py --imgSize 64 --dataset LINK/TO/UNSEENDATA --batch_size 1 --nIter 2000 --train_size 75

batch size specifies the number of input images you pass through to the GAN at each time
nIter specifies the number of restoration iterations GAN must go through before outputing the final image.
train_size specifies the number of input images

## Running the CNN
The CNN requires input for training data, test data and the PSF for planet injection. Using these information, the CNN will generate
another set of positive images (speckle+planet) for supervised training. 

To train the CNN, please change directory into the CNN folder and type the following command in the terminal:

    $python CNN_keras.py --datapath LINK/TO/TRAINING --testpath LINK/TO/TEST --psf_path LINK/TO/PSF --checkpt LINK/TO/FOLDER
    
The checkpoint folder contains the history of the training (training_0.csv) and the checkpoint of the trained model. 

There are a number of hyperparameters available for the user to fine tune. Please refer to the code for detailed settings. 
